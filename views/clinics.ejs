<%- include('./partials/head') %>
<h1>Clinics</h1>

<div id="mapid" style="width:400px; height: 700px;"></div>

<script type="text/javascript">
	// LEAFLET
	var mymap = L.map('mapid').setView([17.319093, -88.592259], 8);

	var OpenStreetMap_DE = L.tileLayer('https://{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png', {
	maxZoom: 18,
	attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
	});

	OpenStreetMap_DE.addTo(mymap)

	// HEATMAP
	var testData = {
	  max: 8,
	  data: [//{lat: 24.6408, lng:46.7728, count: 3},{lat: 50.75, lng:-1.55, count: 1}
	  ]
	};


	var cfg = {
	  // radius should be small ONLY if scaleRadius is true (or small radius is intended)
	  // if scaleRadius is false it will be the constant radius used in pixels
	  "radius": 2,
	  "maxOpacity": .8,
	  // scales the radius based on map zoom
	  "scaleRadius": true,
	  // if set to false the heatmap uses the global maximum for colorization
	  // if activated: uses the data maximum within the current map boundaries
	  //   (there will always be a red spot with useLocalExtremas true)
	  "useLocalExtrema": true,
	  // which field name in your data represents the latitude - default "lat"
	  latField: 'lat',
	  // which field name in your data represents the longitude - default "lng"
	  lngField: 'lng',
	  // which field name in your data represents the data value - default "value"
	  valueField: 'count'
	};


	var heatmapLayer = new HeatmapOverlay(cfg);
	heatmapLayer.addTo(mymap)
	heatmapLayer.setData(testData)

	let marker;
	<% for (var i = places.length - 1; i >= 0; i--) { %>
		marker = L.marker([ <%-places[i].latlng.lat%>, <%-places[i].latlng.lng%>]).addTo(mymap)
		marker.bindPopup("<h1><%-places[i].name%></h1><p><a href='/clinics/<%-places[i]._id%>'>Click here for more information</a></p>")
	<% } %>

</script>

<%- places %>

<%- include('./partials/footer') %>
